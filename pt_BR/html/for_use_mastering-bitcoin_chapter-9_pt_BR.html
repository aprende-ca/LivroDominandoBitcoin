<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>A Blockchain</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="blockchain">A Blockchain</h2>
<div class="sectionbody">
<div class="sect2 data-line-4">
<h3 id="_introdução">Introdução</h3>
<div class="paragraph data-line-6">
<p>A estrutura de dados da blockchain é uma lista ordenada de blocos de transações, onde cada bloco está ligado ao bloco anterior. A blockchain pode ser armazenada como um arquivo simples ou em um banco de dados simples. O cliente Bitcoin Core armazena os metadados da blockchain usando o banco de dados LevelDB do Google. Os blocos são interligados de trás para frente, ou seja, cada bloco se refere ao bloco anterior na cadeia. A blockchain é frequentemente visualizada como uma pilha vertical de blocos, com os blocos empilhados uns sobre os outros e com o primeiro bloco servindo como a fundação (o alicerce) que suporta a pilha de blocos. A visualização dos blocos empilhados uns sobre os outros resulta no uso de termos como "altura" para se referir à distância em relação ao primeiro bloco, e "topo" ou "ponta" para se referir ao bloco que foi adicionado mais recentemente.</p>
</div>
<div class="paragraph data-line-8">
<p>Cada bloco contido na blockchain é identificado por um hash, que é gerado utilizando-se o algoritmo de hash criptográfico SHA256 no cabeçalho do bloco. Cada bloco também contém uma referência ao bloco anterior, conhecido como bloco <em>pai</em>, através do campo "hash do bloco anterior" que existe no cabeçalho do bloco. Em outras palavras, cada bloco contém o hash de seu bloco pai dentro de seu próprio cabeçalho. A sequência de hashes ligando cada bloco ao seu bloco pai cria uma cadeia que pode ser seguida retrogradamente até o primeiro bloco que já foi criado, que é conhecido como o <em>bloco gênese</em>.</p>
</div>
<div class="paragraph data-line-10">
<p>Embora um bloco tenha apenas um bloco pai, ele pode temporariamente ter múltiplos blocos filhos. Cada um dos blocos filhos refere-se ao mesmo bloco pai e contém o mesmo hash (o hash do bloco pai) no campo "hash do bloco anterior". Múltiplos blocos filhos surgem quando há uma "bifurcação" da blockchain, uma situação temporária que ocorre quando diferentes blocos são descobertos quase que simultaneamente por diferentes mineradores (ver <a href="#forks">[forks]</a>). No final, somente um bloco filho será incluído na blockchain e a "bifurcação" deixará de existir. Apesar de cada bloco poder ter mais do que um filho, cada bloco pode ter somente um pai. Isso ocorre porque um bloco possui apenas um único campo "hash do bloco anterior", que é uma referência ao seu bloco pai único.</p>
</div>
<div class="paragraph data-line-12">
<p>O campo "hash do bloco anterior" está dentro do cabeçalho do bloco e, portanto, afeta o hash do bloco <em>atual</em>. Se a identidade de um pai muda, a identidade de um filho muda também. Quando o bloco pai é modificado de qualquer maneira, o hash do bloco pai muda. O hash modificado do bloco pai exige uma mudança no campo "hash do bloco anterior" do bloco filho. Isso, por sua vez, faz com que o hash do bloco filho mude, o que requer uma mudança no campo "hash do bloco anterior" do bloco neto, que, por sua vez, muda o hash do bloco neto, e assim por diante. Esse efeito dominó garante que, assim que um bloco tiver muitas gerações o sucedendo, ele não possa ser modificado sem que a pessoa que modificou seja forçada a calcular novamente todos os blocos subsequentes. Como esse novo cálculo exigiria um enorme processamento computacional (e, portanto, um enorme consumo de energia), a existência de uma longa cadeia de blocos faz com que a história profunda da blockchain seja imutável, o que é uma característica-chave para a segurança do bitcoin.</p>
</div>
<div class="paragraph data-line-14">
<p>Uma maneira de imaginar a blockchain seria como um solo, onde os blocos seriam camadas de uma formação geológica, ou como uma amostra do núcleo de uma geleira. As camadas da superfície podem mudar com as estações, ou mesmo serem destruídas antes de terem tempo para se assentarem. Mas quanto mais profundo escavarmos, veremos que maior será a estabilidade das camadas geológicas. Quando você escavar algumas centenas de metros de profundidade, você estará olhando para uma fotografia do passado que permaneceu intocada por milhões de anos. Na blockchain, pode acontecer que os poucos blocos mais recentes tenham que ser revisados, caso haja um novo cálculo da cadeia devido a uma bifurcação. Os seis blocos do topo são como os centímetros mais superficiais do solo. Mas quanto mais fundo você penetrar na blockchain, além dos seis blocos, cada vez menor se torna a probabilidade desses blocos se modificarem. Após 100 blocos de profundidade, há tanta estabilidade que uma transação coinbase—uma transação contendo bitcoins recém-minerados—pode ser gasta. Após alguns milhares de blocos de profundidade (cerca de um mês), a blockchain já é considerada uma história estabelecida, para todos os fins práticos. Apesar de o protocolo sempre permitir que uma cadeia seja desfeita por uma cadeia mais longa, e apesar de sempre existir a possibilidade de qualquer bloco ser revertido, a probabilidade de ocorrência de um evento como esse diminui à medida que o tempo passa, até que ela se torne ínfima.</p>
</div>
</div>
<div class="sect2 data-line-16">
<h3 id="_estrutura_de_um_bloco">Estrutura de um Bloco</h3>
<div class="paragraph data-line-18">
<p>Um bloco é uma estrutura de dados <em>container</em> que agrega as transações para inclusão no livro-razão público, a blockchain. O bloco é composto por um cabeçalho, contendo metadados, seguido por uma longa lista de transações que constituem a maior parte de seu tamanho. O cabeçalho do bloco tem 80 bytes, enquanto uma transação tem, em média, pelo menos 400 bytes e um bloco contém, em média, mais de 1.900 transações. Um bloco completo, com todas as transações, é portanto 10.000 vezes maior do que o cabeçalho do bloco. A <a href="#block_structure1">A estrutura de um bloco</a> descreve a estrutura de um bloco.</p>
</div>
<table id="block_structure1" class="tableblock frame-all grid-all stretch pagebreak-before data-line-24">
<caption class="title">Table 1. A estrutura de um bloco</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tamanho</th>
<th class="tableblock halign-left valign-top">Campo</th>
<th class="tableblock halign-left valign-top">Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tamanho do Bloco</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">O tamanho do bloco, em bytes, após esse campo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">80 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cabeçalho do Bloco</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vários campos formam o cabeçalho do bloco</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1&#x2013;9 bytes (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contador de Transações</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Número de transações que o bloco contém</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variável</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transações</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">As transações registradas nesse bloco</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-33">
<h3 id="block_header">Cabeçalho do Bloco</h3>
<div class="paragraph data-line-35">
<p>O cabeçalho do bloco consiste em três conjuntos de metadados de bloco. Primeiro, existe uma referência ao hash do bloco anterior, que conecta esse bloco ao bloco anterior na blockchain. O segundo conjunto de metadados, a <em>dificuldade</em>, a <em>data e hora (timestamp)</em> e o <em>nonce</em>, está relacionado à competição da mineração, conforme detalhado no <a href="#mining">[mining]</a>. A terceira parte dos metadados é a raiz da árvore de merkle, uma estrutura de dados usada para resumir de maneira eficiente todas as transações contidas no bloco. A <a href="#block_header_structure_ch09">A estrutura do cabeçalho do bloco</a> descreve a estrutura de um cabeçalho de bloco.</p>
</div>
<table id="block_header_structure_ch09" class="tableblock frame-all grid-all stretch data-line-41">
<caption class="title">Table 2. A estrutura do cabeçalho do bloco</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tamanho</th>
<th class="tableblock halign-left valign-top">Campo</th>
<th class="tableblock halign-left valign-top">Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versão</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um número de versão para servir como referência nas atualizações de software/protocolo.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash do Bloco Anterior</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uma referência ao hash do bloco anterior (bloco pai) na cadeia</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raiz de Merkle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um hash da raiz da árvore de merkle das transações desse bloco</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data e Hora (timestamp)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">O momento aproximado em que este bloco foi criado (em segundos decorridos desde a Época Unix)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alvo de Dificuldade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">O alvo de dificuldade do algoritmo de Prova-de-Trabalho para esse bloco</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um contador usado para o algoritmo de Prova-de-Trabalho</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-51">
<p>O nonce, o alvo de dificuldade e a data e hora (<em>timestamp</em>) são usados no processo de mineração e serão discutidos em maiores detalhes no <a href="#mining">[mining]</a>.</p>
</div>
</div>
<div class="sect2 data-line-54">
<h3 id="block_hash">Identificadores dos Blocos: Hash do Cabeçalho e Altura do Bloco</h3>
<div class="paragraph data-line-56">
<p>O identificador primário de um bloco é o seu hash criptográfico, uma impressão digital que é criada ao se fazer um <em>hashing</em> duplo do cabeçalho do bloco usando o algoritmo SHA256. O hash resultante tem 32 bytes e é chamado de <em>hash do bloco</em>, entretanto, seria mais preciso chamá-lo de <em>hash do cabeçalho do bloco</em>, <span role="keep-together">pois apenas o cabeçalho do bloco é usado para computá-lo. Por exemplo,</span> 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f é o hash do bloco do primeiro bloco criado na história do bitcoin. O hash do bloco identifica o bloco de maneira única e sem ambiguidades, e pode ser derivado de maneira independente por qualquer nó, basta fazer um <em>hashing</em> duplo do cabeçalho do bloco com o algoritmo SHA256.</p>
</div>
<div class="paragraph data-line-58">
<p>Note que o hash do bloco não está incluído no interior da estrutura de dados do bloco, nem quando o bloco é transmitido na rede, nem quando ele é armazenado como parte da blockchain no armazenamento persistente de um nó. Ao invés disso, o hash do bloco é processado por cada nó assim que o bloco é recebido da rede. O hash do bloco pode ser armazenado em uma tabela de banco de dados separada como parte dos metadados do bloco, para facilitar a indexação e uma aquisição mais rápida de blocos a partir do disco.</p>
</div>
<div class="paragraph data-line-60">
<p>Uma segunda maneira de se identificar um bloco é através da sua posição na blockchain, que é chamada de <span role="keep-together"><em>altura do bloco</em> (em inglês, _block height_). O primeiro bloco criado no bitcoin está na altura de bloco 0 (zero) e é o</span> <span role="keep-together">mesmo bloco que foi referenciado anteriomente com o seguinte hash de bloco:</span>  000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f. Logo, um bloco pode ser identificado de duas maneiras diferentes: através da referência ao hash do bloco ou através da referência à altura do bloco. Cada bloco subsequente que é adicionado "em cima" daquele bloco inicial está uma posição "mais alta" na blockchain, como se fossem caixas empilhadas umas sobre as outras.</p>
</div>
<div class="paragraph data-line-62">
<p>Além disso, o termo <em>altura de bloco atual</em> (em inglês, <em>current block height</em>) indica o tamanho da blockchain em blocos em um dado momento. Por exemplo, a altura de bloco atual em 1º de março de 2021 era de aproximadamente 672.722, o que significa que havia 672.722 blocos empilhados sobre o primeiro bloco que foi criado em janeiro de 2009.</p>
</div>
<div class="paragraph data-line-64">
<p>Unlike the block hash, the block height is not a unique identifier. Although a single block will always have a specific and invariant block height, the reverse is not true—the block height does not always identify a single block. Two or more blocks might have the same block height, competing for the same position in the blockchain. This scenario is discussed in detail in the section <a href="#forks">[forks]</a>. The block height is also not a part of the block&#8217;s data structure; it is not stored within the block. Each node dynamically identifies a block&#8217;s position (height) in the blockchain when it is received from the Bitcoin network. The block height might also be stored as metadata in an indexed database table for faster retrieval.</p>
</div>
<div class="admonitionblock tip data-line-67">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-68">
<p>O <em>hash do bloco</em> de um determinado bloco sempre identifica um único bloco individualmente. Um bloco também sempre tem uma <em>altura de bloco</em> específica. Entretanto, nem sempre uma altura de bloco específica pode identificar um bloco único. Na verdade, dois ou mais blocos podem competir por uma mesma posição na blockchain.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-71">
<h3 id="_o_bloco_gênese">O Bloco Gênese</h3>
<div class="paragraph data-line-73">
<p>O primeiro bloco na blockchain é chamado de bloco gênese e foi criado em 2009. Ele é o ancestral comum de todos os blocos na blockchain, o que significa que se você escolher qualquer bloco e seguir a cadeia retrogradamente no tempo, você sempre acabará chegando no bloco gênese.</p>
</div>
<div class="paragraph data-line-75">
<p>Every node always starts with a blockchain of at least one block because the genesis block is statically encoded within the Bitcoin client software, such that it cannot be altered. Every node always "knows" the genesis block&#8217;s hash and structure, the fixed time it was created, and even the single transaction within. Thus, every node has the starting point for the blockchain, a secure "root" from which to build a trusted blockchain.</p>
</div>
<div class="paragraph data-line-77">
<p>Veja o bloco gênese codificado estaticamente dentro do cliente do Bitcoin Core, em <a href="https://bit.ly/1x6rcwP" data-href="https://bit.ly/1x6rcwP"><em>chainparams.cpp</em></a>.</p>
</div>
<div class="paragraph data-line-79">
<p>O seguinte hash identificador pertence ao bloco gênese:</p>
</div>
<div class="listingblock data-line-81">
<div class="content">
<pre>000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</pre>
</div>
</div>
<div class="paragraph data-line-85">
<p>Você pode pesquisar esse hash de bloco em qualquer site do explorador de bloco, como <em>Blockchain.com</em>, e encontrará uma página que descreve o conteúdo desse bloco, com um URL contendo esse hash:</p>
</div>
<div class="paragraph data-line-87">
<p><a href="https://www.blockchain.com/btc/block/000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f" class="undefined" data-href="https://www.blockchain.com/btc/block/000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f">https://www.blockchain.com/btc/block/000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</a></p>
</div>
<div class="paragraph data-line-89">
<p>Usando o cliente de referência Bitcoin Core na linha de comando:</p>
</div>
<div class="listingblock data-line-91">
<div class="content">
<pre>$ bitcoin-cli getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</pre>
</div>
</div>
<div class="listingblock data-line-95">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "hash" : "000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f",
    "confirmations" : 308321,
    "size" : 285,
    "height" : 0,
    "version" : 1,
    "merkleroot" : "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",
    "tx" : [
        "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b"
    ],
    "time" : 1231006505,
    "nonce" : 2083236893,
    "bits" : "1d00ffff",
    "difficulty" : 1.00000000,
    "nextblockhash" : "00000000839a8e6886ab5951d76f411475428afc90947ee320161bbf18eb6048"
}</code></pre>
</div>
</div>
<div class="paragraph data-line-114">
<p>O bloco gênese contém uma mensagem escondida em seu interior. A entrada da transação coinbase contém o texto "<em>The Times 03/Jan/2009 Chancellor on brink of second bailout for banks</em>" (em português, "The Times 03/Jan/2009 Chanceler prestes a realizar um segundo resgate aos bancos"). Essa mensagem tinha como objetivo servir como prova da data mais precoce em que esse bloco foi criado, ao usar como referência a manchete de um jornal britânico, o <em>The Times</em>. Ela também serve como um lembrete da importância de um sistema monetário independente, com o lançamento do bitcoin ocorrendo ao mesmo tempo em que ocorria uma crise monetária internacional sem precedentes. A mensagem foi embutida no primeiro bloco por Satoshi Nakamoto, o criador do bitcoin.</p>
</div>
</div>
<div class="sect2 data-line-116">
<h3 id="_ligando_os_blocos_na_blockchain">Ligando os Blocos na Blockchain</h3>
<div class="paragraph data-line-118">
<p>Os nós completos do bitcoin mantêm uma cópia local da blockchain, que inicia no bloco gênese. A cópia local da blockchain é constantemente atualizada à medida que novos blocos são encontrados e são usados para estender a cadeia. Assim que um nó recebe os blocos vindo da rede, ele validará esses blocos e depois irá ligá-los à blockchain existente. Para estabelecer essa ligação, o nó examinará o cabeçalho do bloco recebido da rede e procurará pelo "hash do bloco anterior".</p>
</div>
<div class="paragraph data-line-120">
<p>Vamos supor, por exemplo, que um nó tenha 277.314 blocos na cópia local da blockchain. O último bloco que o nó conhece é o bloco 277.314, que tem o seguinte hash de cabeçalho de bloco:</p>
</div>
<div class="listingblock data-line-122">
<div class="content">
<pre>00000000000000027e7ba6fe7bad39faf3b5a83daed765f05f7d1b71a1632249</pre>
</div>
</div>
<div class="paragraph data-line-126">
<p>The Bitcoin node then receives a new block from the network, which it parses as follows:</p>
</div>
<div class="listingblock data-line-129">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "size" : 43560,
    "version" : 2,
    "previousblockhash" :
        "00000000000000027e7ba6fe7bad39faf3b5a83daed765f05f7d1b71a1632249",
    "merkleroot" :
        "5e049f4030e0ab2debb92378f53c0a6e09548aea083f3ab25e1d94ea1155e29d",
    "time" : 1388185038,
    "difficulty" : 1180923195.25802612,
    "nonce" : 4215469401,
    "tx" : [
        "257e7497fb8bc68421eb2c7b699dbab234831600e7352f0d9e6522c7cf3f6c77",

 #[... muitas outras transações omitidas ...]

        "05cfd38f6ae6aa83674cc99e4d75a1458c165b7ab84725eda41d018a09176634"
    ]
}</code></pre>
</div>
</div>
<div class="paragraph data-line-150">
<p>Olhando para esse novo bloco, o nó encontra o campo previousblockhash (hash do bloco anterior), que contém o hash do seu bloco pai. Ele é um hash que o nó já conhece, que corresponde ao hash do último bloco na cadeia, que está na altura 277.314. Logo, esse novo bloco é um bloco filho do último bloco na cadeia e estende a blockchain existente. O nó adiciona esse novo bloco ao fim da cadeia, aumentando o comprimento da blockchain, que agora tem uma nova altura de 277.315. A <a href="#chain_of_blocks">Blocos ligados em uma cadeia, através da referência ao hash do cabeçalho do bloco anterior</a> mostra a cadeia de três blocos, ligados através das referências contidas no campo previousblockhash (hash do bloco anterior).</p>
</div>
</div>
<div class="sect2 data-line-154">
<h3 id="merkle_trees">Árvores de Merkle</h3>
<div class="paragraph data-line-156">
<p>Each block in the Bitcoin blockchain contains a summary of all the transactions in the block using a <em>merkle tree</em>.</p>
</div>
<div class="paragraph data-line-158">
<p>Uma <em>árvore de merkle</em>, também conhecida como <em>árvore de hash binária</em>, é uma estrutura de dados usada para resumir e verificar a integridade de grandes conjuntos de dados de maneira eficiente. As árvores de merkle são árvores binárias que contêm hashes criptográficos. O termo "árvore" é usado na ciência da computação para descrever uma estrutura de dados ramificada, mas essas árvores geralmente são exibidas de cabeça para baixo, com a "raiz" no topo e as "folhas" na porção inferior de um diagrama, como você verá nos exemplos a seguir.</p>
</div>
<div id="chain_of_blocks" class="imageblock smallerfourtyfive data-line-163">
<div class="content">
<img src="images/mbc2_0901.png" alt="mbc2 0901">
</div>
<div class="title">Figure 1. Blocos ligados em uma cadeia, através da referência ao hash do cabeçalho do bloco anterior</div>
</div>
<div class="paragraph data-line-165">
<p>As árvores de merkle são usadas no bitcoin para resumir todas as transações contidas em um bloco, produzindo uma impressão digital geral de todo o conjunto de transações, fornecendo um processo muito eficiente para verificar se uma transação foi incluída em um bloco. Uma árvore de merkle é construída através do <em>hashing</em> recursivo de pares de nós até que só haja um único hash, que é conhecido como a <em>raiz</em> ou <em>raiz de merkle</em>. O algoritmo de hash criptográfico usado nas árvores de merkle do bitcoin é o SHA256 aplicado duas vezes, também conhecido como SHA256 duplo.</p>
</div>
<div class="paragraph data-line-167">
<p>Quando N elementos de dados são submetidos a <em>hashing</em> e são resumidos em uma árvore de merkle, você precisa de no máximo 2*log~2~(N) cálculos para verificar se um elemento foi incluído na árvore, o que demonstra que a árvore de merkle é uma estrutura de dados muito eficiente.</p>
</div>
<div class="paragraph data-line-169">
<p>A árvore de merkle é construída de baixo para cima. No exemplo a seguir, iniciamos com quatro transações, A, B, C e D, que formam as <em>folhas</em> da árvore de merkle, como demonstrado na <a href="#simple_merkle">Calculando os nós em uma árvore de merkle</a>. As transações não são armazenadas na árvore de merkle; em vez disso, seus dados são transformados em hash, e o hash resultante é armazenado em cada nó folha como H<sub>A</sub>, H<sub>B</sub>, H<sub>C</sub> e H<sub>D</sub>:</p>
</div>
<pre data-type="codelisting">
H<sub>A</sub> = SHA256(SHA256(Transação A))
</pre>
<div class="paragraph data-line-177">
<p>Os pares consecutivos de nós folhas são então resumidos em um nó pai, ao se concatenar dois hashes e fazendo um <em>hashing</em> dos dois juntos. Por exemplo, para construir um nó pai H<sub>AB</sub>, os dois hashes de 32 bytes dos filhos são concatenados para criar uma <em>string</em> de 64 bytes. Essa <em>string</em> é submetida então a um <em>hashing</em> duplo para produzir o hash do nó pai:</p>
</div>
<pre data-type="codelisting">
H<sub>AB</sub> = SHA256(SHA256(H<sub>A</sub> + H<sub>B</sub>))
</pre>
<div class="paragraph data-line-185">
<p>O processo continua até que haja apenas um único nó no topo, o nó que é conhecido como a raiz de merkle. Esse hash de 32 bytes é armazenado no cabeçalho do bloco e resume todos os dados contidos em todas as quatro transações. A <a href="#simple_merkle">Calculando os nós em uma árvore de merkle</a> mostra como a raiz é calculada através de hashes dos nós agrupados em pares.</p>
</div>
<div id="simple_merkle" class="imageblock data-line-189">
<div class="content">
<img src="images/mbc2_0902.png" alt="merkle_tree">
</div>
<div class="title">Figure 2. Calculando os nós em uma árvore de merkle</div>
</div>
<div class="paragraph data-line-191">
<p>Como a árvore de merkle é uma árvore binária, ela precisa de um número par de nós folha. Se houver um número ímpar de transações para serem resumidas, o hash da última transação será duplicado para criar uma <em>árvore balanceada</em>, ou seja, uma árvore que contém um número par de nós folhas. Isso é demonstrado na <a href="#merkle_tree_odd">A duplicação de um elemento de dados gera um número par de elementos de dados</a>, onde a transação C é duplicada.</p>
</div>
<div id="merkle_tree_odd" class="imageblock data-line-195">
<div class="content">
<img src="images/mbc2_0903.png" alt="merkle_tree_odd">
</div>
<div class="title">Figure 3. A duplicação de um elemento de dados gera um número par de elementos de dados</div>
</div>
<div class="paragraph data-line-197">
<p>O mesmo método que é usado para construir uma árvore a partir de quatro transações pode ser generalizado para construir árvores de qualquer tamanho. No bitcoin é comum existirem centenas a milhares de transações em um único bloco, que podem ser resumidas exatamente da mesma maneira, ao produzir uma única raiz de merkle com apenas 32 bytes de dados. Na <a href="#merkle_tree_large">Uma árvore de merkle resumindo muitos elementos de dados</a>, você verá uma árvore construída a partir de 16 transações. Note que embora a raiz aparente ser maior do que os nós folhas no diagrama, ela tem exatamente o mesmo tamanho, apenas 32 bytes. Não importa se um bloco tem apenas uma ou centenas de milhares de transações, a raiz de merkle sempre as resumirá em 32 bytes.</p>
</div>
<div class="paragraph data-line-199">
<p>To prove that a specific transaction is included in a block, a node only needs to produce log~2~(N) 32-byte hashes, constituting an <em>authentication path</em> or <em>merkle path</em> connecting the specific transaction to the root of the tree. This is especially important as the number of transactions increases, because the base-2 logarithm of the number of transactions increases much more slowly. This allows Bitcoin nodes to efficiently produce paths of 10 or 12 hashes (320–384 bytes), which can provide proof of a single transaction out of more than a thousand transactions in a megabyte-sized block.</p>
</div>
<div id="merkle_tree_large" class="imageblock data-line-203">
<div class="content">
<img src="images/mbc2_0904.png" alt="merkle_tree_large">
</div>
<div class="title">Figure 4. Uma árvore de merkle resumindo muitos elementos de dados</div>
</div>
<div class="paragraph data-line-205">
<p>Na <a href="#merkle_tree_path">Um caminho de merkle sendo usado para provar a inclusão de um elemento de dados</a>, um nó pode provar que uma transação K foi incluída no bloco ao produzir um caminho de merkle que tenha um comprimento de apenas quatro hashes de 32 bytes (128 bytes no total). O caminho consiste em quatro hashes (os retângulos com fundo escurecido na <a href="#merkle_tree_path">Um caminho de merkle sendo usado para provar a inclusão de um elemento de dados</a>) H<sub>L</sub>, H<sub>IJ</sub>, H<sub>MNOP</sub> e H<sub>ABCDEFGH</sub>. Com esses quatro hashes fornecidos como um caminho de autenticação, qualquer nó consegue provar que o H<sub>K</sub> (o retângulo com fundo preto na parte inferior do diagrama) está incluso na raiz de merkle ao computar quatro hashes pareados adicionais: H<sub>KL</sub>, H<sub>IJKL</sub>, H<sub>IJKLMNOP</sub> e a raiz da árvore de merkle (os quatro retângulos com contorno tracejado no diagrama).</p>
</div>
<div id="merkle_tree_path" class="imageblock data-line-209">
<div class="content">
<img src="images/mbc2_0905.png" alt="merkle_tree_path">
</div>
<div class="title">Figure 5. Um caminho de merkle sendo usado para provar a inclusão de um elemento de dados</div>
</div>
<div class="paragraph data-line-212">
<p>O código no <a href="#merkle_example">Construindo uma árvore de merkle</a> demonstra o processo de criação de uma árvore de merkle desde os hashes dos nós folhas até a raiz, usando a biblioteca libbitcoin para algumas funções auxiliares.</p>
</div>
<div id="merkle_example" class="exampleblock pagebreak-before data-line-217">
<div class="title">Example 1. Construindo uma árvore de merkle</div>
<div class="content">
<div class="listingblock data-line-219">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">Unresolved directive in &lt;stdin&gt; - include::code/merkle.cpp[]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-224">
<p>O <a href="#merkle_example_run">Compilando e executando o código de exemplo merkle.cpp</a> mostra o resultado da compilação e da execução do código de merkle.</p>
</div>
<div id="merkle_example_run" class="exampleblock data-line-228">
<div class="title">Example 2. Compilando e executando o código de exemplo merkle.cpp</div>
<div class="content">
<div class="listingblock data-line-230">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Compilar o código merkle.cpp
$ g++ -o merkle merkle.cpp $(pkg-config --cflags --libs libbitcoin)
# Rodar o executável merkle
$ ./merkle
Lista de hashes da merkle atual:
  32650049a0418e4380db0af81788635d8b65424d397170b8499cdc28c4d27006
  30861db96905c8dc8b99398ca1cd5bd5b84ac3264a4e1b3e65afa1bcee7540c4

Lista de hashes da merkle atual:
  d47780c084bad3830bcdaf6eace035e4c6cbf646d103795d22104fb105014ba3

Resultado: d47780c084bad3830bcdaf6eace035e4c6cbf646d103795d22104fb105014ba3</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-247">
<p>A eficiência da árvore de merkle torna-se óbvia à medida que ela cresce em escala. A <a href="#block_structure2">Eficiência da árvore de merkle</a> mostra a quantidade de dados que precisam ser trocados na forma de um caminho de merkle para se provar que uma transação faz parte de um bloco.</p>
</div>
<table id="block_structure2" class="tableblock frame-all grid-all stretch data-line-252">
<caption class="title">Table 3. Eficiência da árvore de merkle</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nº de transações</th>
<th class="tableblock halign-left valign-top">Tamanho aprox. do bloco</th>
<th class="tableblock halign-left valign-top">Tamanho do caminho (em hashes)</th>
<th class="tableblock halign-left valign-top">Tamanho do caminho (em bytes)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 transações</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 kilobytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 hashes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">512 transações</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128 kilobytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9 hashes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">288 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.048 transações</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512 kilobytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11 hashes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">352 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">65.535 transações</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 megabytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 hashes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512 bytes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-260">
<p>Como você pode ver na tabela, enquanto o tamanho do bloco aumenta rapidamente, de 4 KB com 16 transações até um tamanho de bloco de 16 MB para comportar 65.535 transações, o caminho de merkle necessário para provar a inclusão de uma transação cresce muito mais lentamente, de 128 bytes até somente 512 bytes. Com as árvores de merkle, um nó pode fazer apenas o download dos cabeçalhos dos blocos (80 bytes por bloco) e ainda ser capaz de identificar a inclusão de uma transação em um bloco ao adquirir um pequeno caminho de merkle de um nó completo, sem precisar armazenar ou transmitir a vasta maioria da blockchain, que pode ter vários gigabytes de tamanho. Os nós que não mantêm uma blockchain completa, conhecidos como nós de verificação de pagamento simplificada (SPV), usam caminhos de merkle para verificar as transações sem ter que fazer o download dos blocos completos.</p>
</div>
</div>
<div class="sect2 data-line-262">
<h3 id="_árvores_de_merkle_e_verificação_de_pagamento_simplificada_spv">Árvores de Merkle e Verificação de Pagamento Simplificada (SPV)</h3>
<div class="paragraph data-line-264">
<p>Merkle trees are used extensively by SPV nodes. SPV nodes don&#8217;t have all transactions and do not download full blocks, just block headers. In order to verify that a transaction is included in a block, without having to download all the transactions in the block, they use an authentication path, or merkle path.</p>
</div>
<div class="paragraph data-line-266">
<p>Considere, por exemplo, que um nó de SPV esteja interessado em receber pagamentos para um endereço contido em sua carteira. O nó de SPV estabelecerá um filtro de bloom (ver <a href="#bloom_filters">[bloom_filters]</a>) em suas conexões com os outros pares (nós), limitando-se a receber somente aquelas transações que contiverem os endereços de interesse. Quando um par (nó) vizinho enxergar uma transação que corresponde ao filtro de bloom do nó de SPV, ele enviará aquele bloco usando uma mensagem merkleblock. A mensagem merkleblock contém o cabeçalho do bloco e o caminho de merkle que liga a transação de interesse à raiz de merkle do bloco. O nó de SPV usa esse caminho de merkle para ligar a transação ao bloco e verificar que a transação foi incluída no bloco. O nó de SPV também usa o cabeçalho do bloco para ligar o bloco ao resto da blockchain. A combinação dessas duas ligações, entre a transação e o bloco, e entre o bloco e a blockchain, comprova que a transação foi registrada na blockchain. No final, o nó de SPV terá recebido menos que um kilobyte de dados para o cabeçalho do bloco e o caminho de merkle, uma quantidade de dados que é mais do que mil vezes menor do que um bloco completo (cerca de 1 megabyte atualmente).</p>
</div>
</div>
<div class="sect2 data-line-268">
<h3 id="_blockchains_de_testes_do_bitcoin">Blockchains de Testes do Bitcoin</h3>
<div class="paragraph data-line-270">
<p>You might be surprised to learn that there is more than one Bitcoin blockchain. The "main" Bitcoin blockchain, the one created by Satoshi Nakamoto on January 3rd, 2009, the one with the genesis block we studied in this chapter, is called <em>mainnet</em>.  There are other Bitcoin blockchains that are used for testing purposes: at this time <em>testnet</em>, <em>segnet</em>, and <em>regtest</em>. Let&#8217;s look at each in turn.</p>
</div>
<div class="sect3 data-line-273">
<h4 id="_testneto_playground_de_testes_do_bitcoin">Testnet&#x2014;O Playground de Testes do Bitcoin</h4>
<div class="paragraph data-line-275">
<p>Testnet é o nome da blockchain, da rede e da moeda que são usadas para fins de teste. A testnet é uma rede P2P ativa com recursos completos, com carteiras, bitcoins de teste (moedas da testnet), mineração e todos os outros recursos da mainnet. Na verdade, existem apenas duas diferenças: as moedas da testnet não têm valor e a dificuldade de mineração deve ser baixa o suficiente para que qualquer pessoa possa minerar moedas da testnet com relativa facilidade (mantendo-as sem valor).</p>
</div>
<div class="paragraph data-line-277">
<p>Qualquer desenvolvimento de software destinado para uso em produção na rede principal (mainnet) do bitcoin deve primeiro ser testado na testnet com moedas de teste (test coins). Isso protege os desenvolvedores de perdas monetárias devido a bugs e protege a rede de comportamento não intencional devido a bugs.</p>
</div>
<div class="paragraph data-line-279">
<p>Manter as moedas sem valor e a mineração fácil, entretanto, é uma tarefa difícil. Apesar dos apelos dos desenvolvedores, algumas pessoas usam equipamentos avançados de mineração (GPUs e ASICs) para minerar na testnet. Isso aumenta a dificuldade, torna impossível minerar com uma CPU e, eventualmente, dificulta tanto a obtenção de moedas de teste, que as pessoas começam a valorizá-las. Como resultado, de tempos em tempos, a testnet precisa ser descartada e reiniciada a partir de um novo bloco gênese, reiniciando a dificuldade.</p>
</div>
<div class="paragraph data-line-281">
<p>A testnet atual é chamada de <em>testnet3</em>, a terceira iteração de testnet, reiniciada em fevereiro de 2011 para redefinir a dificuldade da testnet anterior.</p>
</div>
<div class="paragraph data-line-283">
<p>Tenha em mente que a testnet3 é uma blockchain pesada, que já tinha mais de 25 GB no ano de 2021. Ela levará um dia ou mais para ser totalmente sincronizada e usará recursos do seu computador. Não tanto quanto a mainnet usará, mas não se pode dizer que ela é uma blockchain "leve". Uma boa maneira de se executar um nó da testnet é através de uma imagem de máquina virtual (por exemplo, VirtualBox, Docker, Cloud Server, etc.) dedicada a esse propósito.</p>
</div>
<div class="sect4 data-line-285">
<h5 id="_usando_a_testnet">Usando a testnet</h5>
<div class="paragraph data-line-287">
<p>O Bitcoin Core, como quase todos os outros softwares do bitcoin, tem suporte total para operações na testnet. Todas as funções do Bitcoin Core também funcionam na testnet, incluindo a carteira, a mineração de moedas da testnet e a sincronização de um nó completo na testnet.</p>
</div>
<div class="paragraph data-line-289">
<p>Para iniciar o Bitcoin Core na testnet em vez da mainnet, use o <em>switch</em> testnet:</p>
</div>
<div class="listingblock data-line-291">
<div class="content">
<pre>$ bitcoind -testnet</pre>
</div>
</div>
<div class="paragraph data-line-295">
<p>Nos logs, você verá que o bitcoind está construindo uma nova blockchain no subdiretório testnet3 do diretório padrão bitcoind:</p>
</div>
<div class="listingblock data-line-297">
<div class="content">
<pre>bitcoind: Usando o diretório de dados /home/nomedousuario/.bitcoin/testnet3</pre>
</div>
</div>
<div class="paragraph data-line-301">
<p>Para conectar-se ao bitcoind, use a ferramenta de linha de comando bitcoin-cli, mas também é necessário alterná-la para o modo testnet:</p>
</div>
<div class="listingblock data-line-303">
<div class="content">
<pre>$ bitcoin-cli -testnet getblockchaininfo
{
  "chain": "test",
  "blocks": 1088,
  "headers": 139999,
  "bestblockhash": "0000000063d29909d475a1c4ba26da64b368e56cce5d925097bf3a2084370128",
  "difficulty": 1,
  "mediantime": 1337966158,
  "verificationprogress": 0.001644065914099759,
  "chainwork": "0000000000000000000000000000000000000000000000000000044104410441",
  "pruned": false,
  "softforks": [

  [...]</pre>
</div>
</div>
<div class="paragraph data-line-320">
<p>Você também pode usar a testnet3 em outras implementações de nó completo, como a btcd (escrita em Go) e a bcoin (escrita em JavaScript), para experimentar e aprender em outras linguagens de programação e outros <em>frameworks</em>.</p>
</div>
<div class="paragraph data-line-322">
<p>Em 2021, a testnet3 oferece suporte a todos os recursos da mainnet, incluindo a Segregated Witness (ver <a href="#segwit">[segwit]</a>). Portanto, a testnet3 também pode ser usada para testar os recursos da Segregated Witness.</p>
</div>
</div>
</div>
<div class="sect3 data-line-324">
<h4 id="_segneta_testnet_da_segregated_witness">Segnet&#x2014;A Testnet da Segregated Witness</h4>
<div class="paragraph data-line-327">
<p>Em 2016, uma testnet de propósito especial foi lançada para auxiliar no desenvolvimento e nos testes da Segregated Witness (também conhecida como segwit; ver <a href="#segwit">[segwit]</a>). Esta blockchain de testes é chamada de segnet e pode ser utilizada executando-se uma versão especial (um <em>branch</em>) do Bitcoin Core.</p>
</div>
<div class="paragraph data-line-329">
<p>Como a segwit foi adicionada à testnet3, não é mais necessário usar a segnet para se testar os recursos da segwit.</p>
</div>
<div class="paragraph data-line-331">
<p>No futuro, é provável que vejamos outras blockchains de testnet que serão projetadas especificamente para testar um único recurso ou uma grande mudança arquitetural, como a segnet.</p>
</div>
</div>
<div class="sect3 data-line-333">
<h4 id="_regtesta_blockchain_local">Regtest&#x2014;A Blockchain Local</h4>
<div class="paragraph data-line-335">
<p> A regtest, que significa "Teste de Regressão", é um recurso do Bitcoin Core que permite criar uma blockchain local para fins de teste. Ao contrário da testnet3, que é uma blockchain de testes pública e compartilhada, as blockchains de regtest foram feitas para serem executadas como sistemas fechados usados para testes locais. Você lança uma blockchain regtest do zero, criando um bloco gênese local. Você pode adicionar outros nós à rede, ou executá-la com um único nó apenas para testar o software Bitcoin Core.</p>
</div>
<div class="paragraph data-line-337">
<p>Para iniciar o Bitcoin Core no modo regtest, use a <em>flag</em> regtest:</p>
</div>
<div class="listingblock data-line-339">
<div class="content">
<pre>$ bitcoind -regtest</pre>
</div>
</div>
<div class="paragraph data-line-343">
<p>Assim como acontece com a testnet, o Bitcoin Core inicializará uma nova blockchain no subdiretório <em>regtest</em> do seu diretório padrão bitcoind:</p>
</div>
<div class="listingblock data-line-345">
<div class="content">
<pre>bitcoind: Usando o diretório de dados /home/nomedousuario/.bitcoin/regtest</pre>
</div>
</div>
<div class="paragraph data-line-349">
<p>Para usar a ferramenta de linha de comando, você também precisa especificar a <em>flag</em> regtest. Vamos usar o comando getblockchaininfo para inspecionar a blockchain da regtest:</p>
</div>
<div class="listingblock data-line-351">
<div class="content">
<pre>$ bitcoin-cli -regtest getblockchaininfo
{
  "chain": "regtest",
  "blocks": 0,
  "headers": 0,
  "bestblockhash": "0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206",
  "difficulty": 4.656542373906925e-10,
  "mediantime": 1296688602,
  "verificationprogress": 1,
  "chainwork": "0000000000000000000000000000000000000000000000000000000000000002",
  "pruned": false,
  [...]</pre>
</div>
</div>
<div class="paragraph data-line-366">
<p>Como você pode ver, ainda não há nenhum bloco. Vamos minerar alguns (500 blocos) e ganhar a recompensa:</p>
</div>
<div class="listingblock data-line-368">
<div class="content">
<pre>$ bitcoin-cli -regtest generate 500
[
  "7afed70259f22c2bf11e406cb12ed5c0657b6e16a6477a9f8b28e2046b5ba1ca",
  "1aca2f154a80a9863a9aac4c72047a6d3f385c4eec5441a4aafa6acaa1dada14",
  "4334ecf6fb022f30fbd764c3ee778fabbd53b4a4d1950eae8a91f1f5158ed2d1",
  "5f951d34065efeaf64e54e91d00b260294fcdfc7f05dbb5599aec84b957a7766",
  "43744b5e77c1dfece9d05ab5f0e6796ebe627303163547e69e27f55d0f2b9353",
   [...]
  "6c31585a48d4fc2b3fd25521f4515b18aefb59d0def82bd9c2185c4ecb754327"
]</pre>
</div>
</div>
<div class="paragraph data-line-381">
<p>A mineração de todos esses blocos levará apenas alguns segundos, o que certamente facilita a realização de testes. Se você verificar o saldo da sua carteira, você verá que ganhou recompensas pelos primeiros 400 blocos (as recompensas das transações coinbase precisam ter 100 blocos de profundidade para que você possa gastá-las):</p>
</div>
<div class="listingblock data-line-383">
<div class="content">
<pre>$ bitcoin-cli -regtest getbalance
12462.50000000</pre>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-388">
<h3 id="_usando_blockchains_de_testes_para_desenvolvimento">Usando Blockchains de Testes para Desenvolvimento</h3>
<div class="paragraph data-line-390">
<p>As várias blockchains do bitcoin (regtest, segnet, testnet3 e mainnet) oferecem uma variedade de ambientes de testes para o desenvolvimento bitcoin. Use as blockchains de testes se você estiver desenvolvendo para o Bitcoin Core ou outro cliente de consenso de nó completo; um aplicativo como uma carteira, exchange ou site de comércio eletrônico; ou até mesmo se estiver desenvolvendo novos contratos inteligentes e scripts complexos.</p>
</div>
<div class="paragraph data-line-392">
<p>Você pode usar as blockchains de testes para estabelecer uma sequência de desenvolvimento. Teste seu código localmente na regtest enquanto você o desenvolve. Quando estiver pronto para experimentá-lo em uma rede pública, mude para a testnet para expor seu código a um ambiente mais dinâmico, com mais diversidade de códigos e aplicativos. Finalmente, quando você estiver confiante de que seu código funciona conforme o esperado, mude para a mainnet para colocá-lo em produção. Conforme você faz alterações, melhorias, correções de bugs, etc., inicie a sequência de desenvolvimento novamente, implementando cada alteração primeiro na regtest, depois na testnet e, finalmente, colocando em produção na mainnet.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-07-10 05:52:49 -0400
</div>
</div>
</body>
</html>