<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>A Rede Bitcoin</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="bitcoin_network_ch08">A Rede Bitcoin</h2>
<div class="sectionbody">
<div class="sect2 data-line-4">
<h3 id="_arquitetura_de_rede_par_a_par">Arquitetura de Rede Par-a-Par</h3>
<div class="paragraph data-line-6">
<p>Bitcoin is structured as a peer-to-peer network architecture on top of the internet. The term peer-to-peer, or P2P, means that the computers that participate in the network are peers to each other, that they are all equal, that there are no "special" nodes, and that all nodes share the burden of providing network services. The network nodes interconnect in a mesh network with a "flat" topology. There is no server, no centralized service, and no hierarchy within the network. Nodes in a P2P network both provide and consume services at the same time with reciprocity acting as the incentive for participation. P2P networks are inherently resilient, decentralized, and open. A preeminent example of a P2P network architecture was the early internet itself, where nodes on the IP network were equal. Today&#8217;s internet architecture is more hierarchical, but the Internet Protocol still retains its flat-topology essence. Beyond bitcoin, the largest and most successful application of P2P technologies is file sharing, with Napster as the pioneer and BitTorrent as the most recent evolution of the architecture.</p>
</div>
<div class="paragraph data-line-8">
<p>A arquitetura da rede P2P do bitcoin é muito mais do que uma escolha de topologia. O bitcoin é projetado para ser um sistema de dinheiro em espécie digital P2P, e a arquitetura da rede é tanto um reflexo quanto uma base fundamental dessa característica-chave. A descentralização do controle é um princípio-chave do projeto, e ela só pode ser obtida e mantida através de uma rede de consenso P2P descentralizada.</p>
</div>
<div class="paragraph data-line-10">
<p>The term "Bitcoin network" refers to the collection of nodes running the bitcoin P2P protocol. In addition to the bitcoin P2P protocol, there are other protocols such as Stratum that are used for mining and lightweight or mobile wallets. These additional protocols are provided by gateway routing servers that access the Bitcoin network using the bitcoin P2P protocol and then extend that network to nodes running other protocols. For example, Stratum servers connect Stratum mining nodes via the Stratum protocol to the main Bitcoin network and bridge the Stratum protocol to the bitcoin P2P protocol. We use the term "extended Bitcoin network" to refer to the overall network that includes the bitcoin P2P protocol, pool-mining protocols, the Stratum protocol, and any other related protocols connecting the components of the Bitcoin system.</p>
</div>
</div>
<div class="sect2 data-line-12">
<h3 id="_tipos_de_nó_e_suas_funções">Tipos de Nó e suas Funções</h3>
<div class="paragraph data-line-14">
<p>Although nodes in the bitcoin P2P network are equal, they may take on different roles depending on the functionality they are supporting. A Bitcoin node is a collection of functions: routing, the blockchain database, mining, and wallet services. A full node with all four of these functions is shown in <a href="#full_node_reference">A Bitcoin network node with all four functions: wallet, miner, full blockchain database, and network routing</a>.</p>
</div>
<div id="full_node_reference" class="imageblock smallerfifty data-line-19">
<div class="content">
<img src="images/mbc2_0801.png" alt="FullNodeReferenceClient_Small">
</div>
<div class="title">Figure 1. A Bitcoin network node with all four functions: wallet, miner, full blockchain database, and network routing</div>
</div>
<div class="paragraph data-line-21">
<p>Todos os nós incluem a função de roteamento para participar na rede e podem incluir outras funcionalidades adicionais. Todos os nós validam e propagam as transações e os blocos, e descobrem e mantêm conexões com outros pares. No exemplo de nó completo da <a href="#full_node_reference">A Bitcoin network node with all four functions: wallet, miner, full blockchain database, and network routing</a>, a função de roteamento é indicada por um círculo com a letra "N", indicando um "Nó Roteador da Rede".</p>
</div>
<div class="paragraph data-line-23">
<p>Alguns nós, chamados de nós completos, também mantêm uma cópia completa e atualizada da blockchain. Os nós completos conseguem verificar de maneira autônoma e confiável qualquer transação, sem depender de uma referência externa. Alguns nós mantêm somente uma parte da blockchain e verificam as transações utilizando um método conhecido como <em>verificação de pagamento simplificada</em> (em inglês, <em>simplified payment verification</em> ou SPV). Estes nós são conhecidos como nós de SPV ou nós leves (em inglês, <em>lightweight</em>). No exemplo de nó completo da figura, a função de banco de dados da blockchain de um nó completo está indicada por um círculo contendo a letra "B", indicando uma "Blockchain Completa". Na <a href="#bitcoin_network">The extended Bitcoin network showing various node types, gateways, and protocols</a>, os nós de SPV estão representados sem o círculo contendo a letra "B", indicando que eles não têm uma cópia completa da blockchain.</p>
</div>
<div class="paragraph data-line-25">
<p>Mining nodes compete to create new blocks by running specialized hardware to solve the Proof-of-Work algorithm. Some mining nodes are also full nodes, maintaining a full copy of the blockchain, while others are lightweight nodes participating in pool mining and depending on a pool server to maintain a full node. The mining function is shown in the full node as a circle called "Miner" or the letter "M."</p>
</div>
<div class="paragraph data-line-27">
<p>User wallets might be part of a full node, as is usually the case with desktop Bitcoin clients. Increasingly, many user wallets, especially those running on resource-constrained devices such as smartphones, are SPV nodes. The wallet function is shown in <a href="#full_node_reference">A Bitcoin network node with all four functions: wallet, miner, full blockchain database, and network routing</a> as a circle called "Wallet" or the letter "W."</p>
</div>
<div class="paragraph data-line-29">
<p>Além dos tipos de nós principais no protocolo P2P do bitcoin, existem também servidores e nós executando outros protocolos, como protocolos especializados de mineração em pool e protocolos de acesso de clientes leves.</p>
</div>
<div class="paragraph data-line-31">
<p><a href="#node_type_ledgend">Different types of nodes on the extended Bitcoin network</a> shows the most common node types on the extended Bitcoin network.</p>
</div>
</div>
<div class="sect2 data-line-33">
<h3 id="_a_rede_bitcoin_estendida">A Rede Bitcoin Estendida</h3>
<div class="paragraph data-line-35">
<p>The main Bitcoin network, running the bitcoin P2P protocol, consists of between 5,000 and 8,000 listening nodes running various versions of the bitcoin reference client (Bitcoin Core) and a few hundred nodes running various other implementations of the bitcoin P2P protocol, such as Bitcoin Classic, Bitcoin Unlimited, BitcoinJ, Libbitcoin, btcd, and bcoin. A small percentage of the nodes on the bitcoin P2P network are also mining nodes, competing in the mining process, validating transactions, and creating new blocks. Various large companies interface with the Bitcoin network by running full-node clients based on the Bitcoin Core client, with full copies of the blockchain and a network node, but without mining or wallet functions. These nodes act as network edge routers, allowing various other services (exchanges, wallets, block explorers, merchant payment processing) to be built on top.</p>
</div>
<div class="paragraph data-line-37">
<p>The extended Bitcoin network includes the network running the bitcoin P2P protocol, described earlier, as well as nodes running specialized protocols. Attached to the main bitcoin P2P network are a number of pool servers and protocol gateways that connect nodes running other protocols. These other protocol nodes are mostly pool mining nodes (see <a href="#mining">[mining]</a>) and lightweight wallet clients, which do not carry a full copy of the blockchain.</p>
</div>
<div class="paragraph data-line-39">
<p><a href="#bitcoin_network">The extended Bitcoin network showing various node types, gateways, and protocols</a> shows the extended Bitcoin network with the various types of nodes, gateway servers, edge routers, and wallet clients and the various protocols they use to connect to each other.</p>
</div>
<div id="node_type_ledgend" class="imageblock data-line-43">
<div class="content">
<img src="images/mbc2_0802.png" alt="BitcoinNodeTypes">
</div>
<div class="title">Figure 2. Different types of nodes on the extended Bitcoin network</div>
</div>
<div id="bitcoin_network" class="imageblock data-line-47">
<div class="content">
<img src="images/mbc2_0803.png" alt="BitcoinNetwork">
</div>
<div class="title">Figure 3. The extended Bitcoin network showing various node types, gateways, and protocols</div>
</div>
</div>
<div class="sect2 data-line-49">
<h3 id="_redes_de_retransmissão_do_bitcoin">Redes de Retransmissão do Bitcoin</h3>
<div class="paragraph data-line-51">
<p>While the bitcoin P2P network serves the general needs of a broad variety of node types, it exhibits too high network latency for the specialized needs of bitcoin mining nodes.</p>
</div>
<div class="paragraph data-line-53">
<p>Os mineradores do bitcoin estão envolvidos em uma competição apertada no tempo para resolver o problema da Prova-de-Trabalho e estender a blockchain (ver o <a href="#mining">[mining]</a>). Ao participarem desta competição, os mineradores do bitcoin precisam minimizar o tempo entre a propagação de um bloco vencedor e o início da próxima rodada da competição. Na mineração, a latência da rede está diretamente relacionada às margens de lucro.</p>
</div>
<div class="paragraph data-line-55">
<p>Uma <em>Rede de Transmissão de Bitcoin</em> (Bitcoin Relay Network) é uma rede que tenta minimizar a latência na transmissão de blocos entre os mineradores. A <a href="https://www.bitcoinrelaynetwork.org" data-href="https://www.bitcoinrelaynetwork.org">Bitcoin Relay Network</a> original foi criada pelo desenvolvedor principal Matt Corallo em 2015 para permitir a sincronização rápida dos blocos entre os mineradores com latência muito baixa. A rede consistia em vários nodes especializados hospedados na infraestrutura da Amazon Web Services em todo o mundo e servia para conectar a maioria dos mineradores e das pools de mineração.</p>
</div>
<div class="paragraph data-line-57">
<p>  A Bitcoin Relay Network original foi substituída em 2016 com a introdução do <em>Fast Internet Bitcoin Relay Engine</em> (Motor de Rede de Transmissão Rápida de Bitcoin) ou <a href="https://bitcoinfibre.org" data-href="https://bitcoinfibre.org"><em>FIBRE</em></a>, também criado pelo desenvolvedor principal Matt Corallo. A FIBER é uma rede de retransmissão baseada em UDP que retransmite blocos dentro de uma rede de nodes. A FIBER implementa a otimização do <em>bloco compacto</em> para reduzir ainda mais a quantidade de dados transmitidos e a latência da rede.</p>
</div>
<div class="paragraph data-line-59">
<p>As redes de retransmissão não são substitutos para a rede P2P do bitcoin. Em vez disso, são redes de sobreposição que fornecem conectividade adicional entre nós que possuem necessidades especializadas. Assim como as rodovias não substituem as estradas rurais, mas servem como atalhos entre dois pontos com tráfego intenso, você ainda precisará das estradas menores para poder chegar às rodovias.</p>
</div>
</div>
<div class="sect2 data-line-61">
<h3 id="_descoberta_da_rede">Descoberta da Rede</h3>
<div class="paragraph data-line-63">
<p>When a new node boots up, it must discover other Bitcoin nodes on the network in order to participate. To start this process, a new node must discover at least one existing node on the network and connect to it. The geographic location of other nodes is irrelevant; the Bitcoin network topology is not geographically defined. Therefore, any existing Bitcoin nodes can be selected at random.</p>
</div>
<div class="paragraph data-line-65">
<p>Para se conectar a um par conhecido, os nós estabelecem uma conexão TCP, geralmente na porta 8333 (a porta que geralmente é usada pelo bitcoin), ou a uma porta alternativa, caso tenha sido fornecida. Ao estabelecer uma conexão, o nó iniciará um "aperto de mão" (ver a <a href="#network_handshake">O aperto de mãos inicial entre os pares</a>) ao transmitir uma mensagem version, que contém informações de identificação básicas, descritas a seguir:</p>
</div>
<div class="dlist data-line-67">
<dl>
<dt class="hdlist1">nVersion</dt>
<dd>
<p>A versão do protocolo P2P do bitcoin que o cliente "fala" (por exemplo, 70002)</p>
</dd>
<dt class="hdlist1">nLocalServices</dt>
<dd>
<p>Uma lista dos serviços locais suportados pelo nó, atualmente apenas NODE_NETWORK</p>
</dd>
<dt class="hdlist1">nTime</dt>
<dd>
<p>A hora atual</p>
</dd>
<dt class="hdlist1">addrYou</dt>
<dd>
<p>O endereço IP do nó remoto, da maneira que ele é visto a partir desse nó</p>
</dd>
<dt class="hdlist1">addrMe</dt>
<dd>
<p>O endereço IP do nó local, da maneira que ele é descoberto pelo nó local</p>
</dd>
<dt class="hdlist1">subver</dt>
<dd>
<p>Uma sub-versão mostrando o tipo de software sendo executado nesse nó (ex: <span class="keep-together"><code>/Satoshi:0.9.2.1/</code></span>)</p>
</dd>
<dt class="hdlist1">BestHeight</dt>
<dd>
<p>A altura de bloco da blockchain deste nó</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-75">
<p>(Veja <a href="https://bit.ly/1qlsC7w" data-href="https://bit.ly/1qlsC7w">GitHub</a> para um exemplo de uma versão de mensagem da rede.)</p>
</div>
<div class="paragraph data-line-77">
<p>A mensagem version é sempre a primeira mensagem a ser enviada de qualquer par para outro par. O par local que recebe uma mensagem version examinará a nVersion relatada pelo par remoto e decidirá se o par remoto é compatível. Se o par remoto for compatível, o par local reconhecerá a mensagem version e estabelecerá uma conexão enviando uma mensagem verack.</p>
</div>
<div class="paragraph data-line-79">
<p>How does a new node find peers? The first method is to query DNS using a number of "DNS seeds," which are DNS servers that provide a list of IP addresses of Bitcoin nodes. Some of those DNS seeds provide a static list of IP addresses of stable bitcoin listening nodes. Some of the DNS seeds are custom implementations of BIND (Berkeley Internet Name Daemon) that return a random subset from a list of Bitcoin node addresses collected by a crawler or a long-running Bitcoin node.  The Bitcoin Core client contains the names of nine different DNS seeds. The diversity of ownership and diversity of implementation of the different DNS seeds offers a high level of reliability for the initial bootstrapping process. In the Bitcoin Core client, the option to use the DNS seeds is controlled by the option switch -dnsseed (set to 1 by default, to use the DNS seed).</p>
</div>
<div class="paragraph data-line-81">
<p>Alternatively, a bootstrapping node that knows nothing of the network must be given the IP address of at least one Bitcoin node, after which it can establish connections through further introductions. The command-line argument -seednode can be used to connect to one node just for introductions using it as a seed. After the initial seed node is used to form introductions, the client will disconnect from it and use the newly discovered peers.</p>
</div>
<div id="network_handshake" class="imageblock data-line-85">
<div class="content">
<img src="images/mbc2_0804.png" alt="NetworkHandshake">
</div>
<div class="title">Figure 4. O aperto de mãos inicial entre os pares</div>
</div>
<div class="paragraph data-line-87">
<p>Assim que uma ou mais conexões são estabelecidas, o novo nó enviará uma mensagem addr contendo o seu próprio endereço IP para seus vizinhos. Seus vizinhos, por suas vezes, retransmitirão a mensagem addr para os vizinhos deles, garantindo que o nó recém-conectado se torne bem conhecido e melhor conectado. Adicionalmente, o nó recém-conectado pode enviar getaddr para os vizinhos, solicitando-lhes que retornem uma lista de endereços IP de outros pares. Dessa maneira, um nó pode encontrar pares para conectar-se e divulgar sua existência na rede para que outros nós o encontrem. A <a href="#address_propagation">Propagação e descoberta de endereço</a> demonstra o protocolo de descoberta de endereço.</p>
</div>
<div id="address_propagation" class="imageblock data-line-92">
<div class="content">
<img src="images/mbc2_0805.png" alt="AddressPropagation">
</div>
<div class="title">Figure 5. Propagação e descoberta de endereço</div>
</div>
<div class="paragraph data-line-94">
<p>A node must connect to a few different peers in order to establish diverse paths into the Bitcoin network. Paths are not persistent—nodes come and go—and so the node must continue to discover new nodes as it loses old connections as well as assist other nodes when they bootstrap. Only one connection is needed to bootstrap, because the first node can offer introductions to its peer nodes and those peers can offer further introductions. It&#8217;s also unnecessary and wasteful of network resources to connect to more than a handful of nodes. After bootstrapping, a node will remember its most recent successful peer connections, so that if it is rebooted it can quickly reestablish connections with its former peer network. If none of the former peers respond to its connection request, the node can use the seed nodes to bootstrap again.</p>
</div>
<div class="paragraph data-line-96">
<p>Em um nó executando o cliente Bitcoin Core, você pode listar as conexões com os pares através do comando getpeerinfo:</p>
</div>
<div class="listingblock data-line-99">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ bitcoin-cli getpeerinfo</code></pre>
</div>
</div>
<div class="listingblock data-line-103">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[
    {
        "addr" : "85.213.199.39:8333",
        "services" : "00000001",
        "lastsend" : 1405634126,
        "lastrecv" : 1405634127,
        "bytessent" : 23487651,
        "bytesrecv" : 138679099,
        "conntime" : 1405021768,
        "pingtime" : 0.00000000,
        "version" : 70002,
        "subver" : "/Satoshi:0.9.2.1/",
        "inbound" : false,
        "startingheight" : 310131,
        "banscore" : 0,
        "syncnode" : true
    },
    {
        "addr" : "58.23.244.20:8333",
        "services" : "00000001",
        "lastsend" : 1405634127,
        "lastrecv" : 1405634124,
        "bytessent" : 4460918,
        "bytesrecv" : 8903575,
        "conntime" : 1405559628,
        "pingtime" : 0.00000000,
        "version" : 70001,
        "subver" : "/Satoshi:0.8.6/",
        "inbound" : false,
        "startingheight" : 311074,
        "banscore" : 0,
        "syncnode" : false
    }
]</code></pre>
</div>
</div>
<div class="paragraph data-line-140">
<p>Para desativar o gerenciamento automático dos pares e especificar uma lista de endereços IP, os usuários podem usar a opção -connect=&lt;EndereçoIP&gt; e especificar um ou mais endereços IP. Se essa opção for utilizada, o nó irá conectar-se somente aos endereços IP selecionados, ao invés de automaticamente descobrir e manter conexões com os pares.</p>
</div>
<div class="paragraph data-line-142">
<p>Se não houver tráfego em uma conexão, os nós periodicamente enviarão uma mensagem para manter a conexão ativa. Se um nó não se comunicar em uma conexão por mais de 90 minutos, assume-se que ele esteja desconectado e um novo par será procurado. Logo, a rede ajusta-se dinamicamente aos nós transitórios e aos problemas da rede, e pode crescer e diminuir organicamente conforme a necessidade, sem precisar de um controle central.</p>
</div>
</div>
<div class="sect2 data-line-144">
<h3 id="_nós_completos">Nós completos</h3>
<div class="paragraph data-line-146">
<p>Full nodes are nodes that maintain a full blockchain with all transactions. More accurately, they probably should be called "full blockchain nodes." In the early years of bitcoin, all nodes were full nodes and currently the Bitcoin Core client is a full blockchain node. In the past two years, however, new forms of Bitcoin clients have been introduced that do not maintain a full blockchain but run as lightweight clients. We&#8217;ll examine these in more detail in the next section.</p>
</div>
<div class="paragraph data-line-148">
<p>Full blockchain nodes maintain a complete and up-to-date copy of the Bitcoin blockchain with all the transactions, which they independently build and verify, starting with the very first block (genesis block) and building up to the latest known block in the network. A full blockchain node can independently and authoritatively verify any transaction without recourse or reliance on any other node or source of information. The full blockchain node relies on the network to receive updates about new blocks of transactions, which it then verifies and incorporates into its local copy of the blockchain.</p>
</div>
<div class="paragraph data-line-150">
<p>Running a full blockchain node gives you the pure bitcoin experience: independent verification of all transactions without the need to rely on, or trust, any other systems. It&#8217;s easy to tell if you&#8217;re running a full node because it requires more than one hundred gigabytes of persistent storage (disk space) to store the full blockchain. If you need a lot of disk and it takes two to three days to sync to the network, you are running a full node. That is the price of complete independence and freedom from central authority.</p>
</div>
<div class="paragraph data-line-152">
<p>There are a few alternative implementations of full blockchain Bitcoin clients, built using different programming languages and software architectures. However, the most common implementation is the reference client Bitcoin Core, also known as the Satoshi client. More than 75% of the nodes on the Bitcoin network run various versions of Bitcoin Core. It is identified as "Satoshi" in the sub-version string sent in the version message and shown by the command getpeerinfo as we saw earlier; for example, /Satoshi:0.8.6/.</p>
</div>
</div>
<div class="sect2 data-line-154">
<h3 id="_trocando_o_inventário">Trocando o "Inventário"</h3>
<div class="paragraph data-line-156">
<p>The first thing a full node will do once it connects to peers is try to construct a complete blockchain. If it is a brand-new node and has no blockchain at all, it only knows one block, the genesis block, which is statically embedded in the client software. Starting with block #0 (the genesis block), the new node will have to download hundreds of thousands of blocks to synchronize with the network and reestablish the full blockchain.</p>
</div>
<div class="paragraph data-line-158">
<p>O processo de sincronização da blockchain é iniciado a partir da mensagem version, pois ela contém a BestHeight, que é a altura atual (o número de blocos) da blockchain de um nó. Ao ver a mensagem version de seus pares, um nó saberá quantos blocos cada um deles tem e será capaz de comparar com o número de blocos que existem em sua própria blockchain. Os nós pareados trocarão uma mensagem getblocks, a qual contém o hash (a impressão digital) do bloco mais alto de suas blockchains locais. A seguir, um dos pares será capaz de identificar que o hash recebido pertence a um bloco que não está no topo, mas que pertence a um bloco antigo, logo deduzindo que sua blockchain local é mais comprida do que a de seu par.</p>
</div>
<div class="paragraph data-line-160">
<p>O par com a blockchain mais comprida possui mais blocos que o outro nó e consegue identificar quais blocos o outro nó precisa para ficar "em dia". Ele identificará os primeiros 500 blocos para serem compartilhados e transmitirá seus hashes usando uma mensagem inv (<em>inventory</em>). O nó que estiver com esses blocos em falta irá então recebê-los, ao emitir uma série de mensagens getdata solicitando os dados completos dos blocos, identificando os blocos solicitados usando os hashes da mensagem inv.</p>
</div>
<div class="paragraph data-line-162">
<p>Vamos assumir, por exemplo, que um nó tenha apenas o bloco gênese. Ele então receberá uma mensagem inv de seus pares contendo os hashes dos próximos 500 blocos na cadeia. Ele começará a solicitar blocos de todos os seus pares conectados, distribuindo o serviço, de maneira que ele não sobrecarregue nenhum de seus pares com requisições. O nó mantém um registro de quantos blocos estão "em trânsito" por conexão com par, que são os blocos que ele solicitou mas não recebeu, certificando-se de que ele não exceda um limite (MAX_BLOCKS_IN_TRANSIT_PER_PEER). Dessa maneira, se ele precisar de muitos blocos, ele só irá solicitar novos blocos quando as solicitações prévias forem completadas, permitindo que os pares controlem o ritmo de updates e não sobrecarregando a rede. À medida que cada bloco é recebido, ele é adicionado à blockchain, conforme veremos no <a href="#blockchain">[blockchain]</a>. À medida que a blockchain local é gradualmente construída, mais blocos são solicitados e recebidos, e o processo continua até que o nó alcance o resto da rede.</p>
</div>
<div class="paragraph data-line-164">
<p>Esse processo—de comparar a blockchain local com as blockchains dos pares e de adquirir os blocos que estão em falta—acontece sempre que um nó fica offline por algum período de tempo. Seja porque um nó ficou apenas alguns minutos offline e está com apenas alguns blocos em falta, seja porque ficou um mês inteiro offline e está com milhares de blocos em falta, o nó sempre enviará inicialmente uma mensagem getblocks, receberá uma resposta inv e, em seguida, começará a baixar os blocos que faltam. A <a href="#inventory_synchronization">Nó sincronizando a blockchain ao adquirir blocos de um par</a> demonstra o inventário e o protocolo de propagação dos blocos.</p>
</div>
<div id="inventory_synchronization" class="imageblock smallerfifty data-line-169">
<div class="content">
<img src="images/mbc2_0806.png" alt="InventorySynchronization">
</div>
<div class="title">Figure 6. Nó sincronizando a blockchain ao adquirir blocos de um par</div>
</div>
</div>
<div class="sect2 data-line-172">
<h3 id="spv_nodes">Nós de Verificação de Pagamento Simplificada (SPV)</h3>
<div class="paragraph data-line-174">
<p>Not all nodes have the ability to store the full blockchain. Many Bitcoin clients are designed to run on space- and power-constrained devices, such as smartphones, tablets, or embedded systems. For such devices, a <em>simplified payment verification</em> (SPV) method is used to allow them to operate without storing the full blockchain. These types of clients are called SPV clients or lightweight clients. As bitcoin adoption surges, the SPV node is becoming the most common form of Bitcoin node, especially for bitcoin wallets.</p>
</div>
<div class="paragraph data-line-176">
<p>Os nós de SPV fazem o download apenas dos cabeçalhos dos blocos, eles não baixam as transações incluídas em cada bloco. A cadeia de blocos resultante, sem as transações, é 1.000 vezes menor do que a blockchain completa. Os nós de SPV não são capazes de construir uma imagem completa de todas as UTXOs que estão disponíveis para serem gastas, visto que eles não conhecem todas as transações da rede. Os nós de SPV verificam as transações usando um método levemente diferente, que depende dos pares para fornecerem, sob demanda, visualizações parciais de partes relevantes da blockchain.</p>
</div>
<div class="paragraph data-line-178">
<p>Como uma analogia, um nó completo é como se fosse um turista em uma cidade estranha, equipado com um mapa detalhado incluindo todas as ruas e todos os endereços da cidade. Em comparação, um nó de SPV é como se fosse um turista em uma cidade estranha, pedindo a pessoas aleatórias na rua orientações de como chegar a um lugar, enquanto ele sabe apenas o nome de uma avenida principal. Embora ambos os turistas possam verificar que uma rua existe ao visitá-la, o turista sem o mapa não sabe o que se passa em cada rua colateral e não sabe quais outras ruas existem na cidade. Ao chegar na frente da Avenida da Igreja, nº23, o turista sem o mapa não tem como saber se existem outros endereços "Avenida da Igreja, nº23" na cidade ou se ele realmente está no endereço correto. A melhor solução para o turista sem mapa é pedir orientações para um número suficiente de pessoas e torcer para que algumas delas não estejam tentando lhe passar a perna.</p>
</div>
<div class="paragraph data-line-180">
<p>A verificação de pagamento simplificada (SPV) verifica as transações através de referências à <em>profundidade</em> delas na blockchain, em vez da <em>altura</em>. Enquanto um nó com a blockchain completa construirá uma cadeia totalmente verificada contendo milhares de blocos e transações que podem ser seguidas na blockchain (retrospectivamente no tempo) até o bloco gênese, um nó de SPV verificará a cadeia de todos os blocos (mas não todas as transações) e ligará essa cadeia à transação de interesse.</p>
</div>
<div class="paragraph data-line-182">
<p>Por exemplo, ao examinar uma transação no bloco 300.000, um nó completo segue todos os 300.000 blocos até o bloco gênese e constrói um banco de dados completo de UTXOs, estabelecendo a validade da transação ao confirmar que a UTXO ainda não foi gasta. Um nó de SPV não consegue validar se a UTXO ainda não foi gasta. Ao invés disso, o nó de SPV estabelecerá uma ligação entre a transação e o bloco que a contém, usando um <em>caminho de merkle</em> (ver <a href="#merkle_trees">[merkle_trees]</a>). Então, o nó de SPV aguarda até ver os seis blocos, do 300.001 até o 300.006, empilhados em cima do bloco contendo a transação e verifica-a ao estabelecer sua profundidade sob os blocos 300.006 a 300.001. O fato de que outros nós na rede aceitaram o bloco 300.000 e então fizeram o trabalho necessário para produzir mais seis blocos em cima dele é a prova, ainda que indireta, de que a transação não foi um gasto duplo.</p>
</div>
<div class="paragraph data-line-184">
<p>An SPV node cannot be persuaded that a transaction exists in a block when the transaction does not in fact exist. The SPV node establishes the existence of a transaction in a block by requesting a merkle path proof and by validating the Proof-of-Work in the chain of blocks. However, a transaction&#8217;s existence can be "hidden" from an SPV node. An SPV node can definitely prove that a transaction exists but cannot verify that a transaction, such as a double-spend of the same UTXO, doesn&#8217;t exist because it doesn&#8217;t have a record of all transactions. This vulnerability can be used in a denial-of-service attack or for a double-spending attack against SPV nodes. To defend against this, an SPV node needs to connect randomly to several nodes, to increase the probability that it is in contact with at least one honest node. This need to randomly connect means that SPV nodes also are vulnerable to network partitioning attacks or Sybil attacks, where they are connected to fake nodes or fake networks and do not have access to honest nodes or the real Bitcoin network.</p>
</div>
<div class="paragraph data-line-186">
<p>Para a maioria dos fins práticos, os nós de SPV bem conectados são seguros o suficiente, alcançando um equilíbrio entre necessidade de recursos, praticidade e segurança. Para uma segurança infalível, no entanto, nada é melhor do que executar um nó com a blockchain completa.</p>
</div>
<div class="admonitionblock tip data-line-189">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-190">
<p>Um nó com a blockchain completa verifica uma transação ao checar toda a cadeia de milhares de blocos abaixo dela, para ter a certeza de que a UTXO já não foi gasta anteriormente, enquanto um nó de SPV verifica uma transação ao checar quão profundo o bloco da transação está enterrado sob uma porção de blocos acima dele.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-193">
<p>Para receber os cabeçalhos dos blocos, os nós de SPV usam uma mensagem getheaders, em vez da mensagem getblocks. O par que responder enviará até 2.000 cabeçalhos de blocos usando uma única mensagem headers. O processo é o mesmo que um nó completo utiliza para receber blocos completos. Os nós de SPV também definem um filtro na conexão com os pares, para filtrar a transmissão de blocos futuros e transações enviadas pelos pares. Quaisquer transações de interesse são recebidas usando uma requisição getdata. Em resposta, o par gera uma mensagem tx contendo as transações. A <a href="#spv_synchronization">Nó de SPV sincronizando os cabeçalhos dos blocos</a> mostra a sincronização dos cabeçalhos dos blocos.</p>
</div>
<div class="paragraph data-line-195">
<p>Because SPV nodes need to retrieve specific transactions in order to selectively verify them, they also create a privacy risk. Unlike full blockchain nodes, which collect all transactions within each block, the SPV node&#8217;s requests for specific data can inadvertently reveal the addresses in their wallet. For example, a third party monitoring a network could keep track of all the transactions requested by a wallet on an SPV node and use those to associate Bitcoin addresses with the user of that wallet, destroying the user&#8217;s privacy.</p>
</div>
<div id="spv_synchronization" class="imageblock data-line-199">
<div class="content">
<img src="images/mbc2_0807.png" alt="SPVSynchronization">
</div>
<div class="title">Figure 7. Nó de SPV sincronizando os cabeçalhos dos blocos</div>
</div>
<div class="paragraph data-line-201">
<p>Logo após a introdução dos nós de SPV e dos nós leves, os desenvolvedores do bitcoin adicionaram uma funcionalidade conhecida como <em>filtros de bloom</em>, com o objetivo de resolver os problemas de privacidade dos nós de SPV. Os filtros de bloom permitem que os nós de SPV recebam um subconjunto de transações sem precisarem revelar em quais endereços eles estão interessados, através de um mecanismo de filtragem que utiliza probabilidades ao invés de padrões fixos.</p>
</div>
</div>
<div class="sect2 data-line-204">
<h3 id="bloom_filters">Filtros de Bloom</h3>
<div class="paragraph data-line-206">
<p>A bloom filter is a probabilistic search filter that offers an efficient way to express a search pattern while protecting privacy. They are used by SPV nodes to ask their peers for transactions matching a specific pattern, without revealing exactly which addresses, keys, or transactions they are searching for.</p>
</div>
<div class="paragraph data-line-208">
<p>Na nossa analogia anterior, uma turista sem um mapa está pedindo orientações para um endereço específico, "Rua da Igreja, 23". Se ela pedir orientações para estranhos nessa rua, ela inadvertidamente revelará seu destino. Um filtro de bloom seria como se ela perguntasse, "Existem ruas nessa vizinhança cujo nome termina em E-J-A?" Uma pergunta como essa revela um pouco menos sobre o destino desejado do que se ela perguntasse especificamente pela "Rua da Igreja, 23". Usando essa técnica, a turista poderia especificar o endereço desejado em mais detalhes, como "termina em R-E-J-A", ou em menos detalhes, como "termina em A". Ao variar a precisão de sua busca, a turista revela mais ou menos informações, à custa de resultados mais ou menos específicos. Se ela pedir orientações com um padrão de busca menos específico, ela receberá muito mais endereços possíveis e terá uma privacidade maior, mas muitos dos resultados serão irrelevantes. Se ela pedir orientações com um padrão de busca muito específico, ela receberá poucos resultados, mas perderá em privacidade.</p>
</div>
<div class="paragraph data-line-210">
<p>Os filtros de bloom cumprem essa função ao permitir que um nó de SPV especifique um padrão de busca para transações que possa ser refinado de acordo com precisão ou privacidade. Um filtro de bloom mais específico produzirá resultados precisos, mas à custa de revelar quais endereços estão na carteira do usuário. Um filtro de bloom menos específico produzirá mais dados sobre mais transações, muitas delas irrelevantes para o nó, mas permitirá que o nó mantenha uma melhor privacidade.</p>
</div>
<div class="sect3 data-line-212">
<h4 id="_como_funcionam_os_filtros_de_bloom">Como Funcionam os Filtros de Bloom</h4>
<div class="paragraph data-line-214">
<p>Os filtros de bloom são implementados como um array (uma lista) de tamanho variável de N dígitos binários (um campo de bits) e um número variável de M funções de hash. As funções de hash são projetadas para sempre produzir um output entre 1 e N, correspondendo ao array de dígitos binários. As funções de hash são geradas deterministicamente, de maneira que qualquer nó implementando um filtro de bloom sempre usará as mesmas funções de hash e sempre receberá os mesmos resultados para um input específico. Ao escolher filtros de bloom de diferentes comprimentos (N) e um número diferente (M) de funções de hash, o filtro de bloom pode ser melhorado, variando o nível de acurácia, e, portanto, de privacidade.</p>
</div>
<div class="paragraph data-line-216">
<p>Na <a href="#bloom1">Um exemplo de um filtro de bloom simples, com um campo de 16 bits e três funções de hash</a>, usamos um array muito pequeno de 16 bits e um conjunto de três funções de hash para demonstrar como os filtros de bloom funcionam.</p>
</div>
<div id="bloom1" class="imageblock data-line-220">
<div class="content">
<img src="images/mbc2_0808.png" alt="Bloom1">
</div>
<div class="title">Figure 8. Um exemplo de um filtro de bloom simples, com um campo de 16 bits e três funções de hash</div>
</div>
<div class="paragraph data-line-222">
<p>O filtro de bloom é inicializado de maneira que o array de bits seja todo de zeros. Para adicionar um padrão ao filtro de bloom, o padrão é transformado em hash por cada função de hash, uma depois da outra. A aplicação da primeira função de hash no input resulta em um número entre 1 e N. O bit correspondente no array (indexada de 1 a N) é encontrado e definido como 1, registrando o output da função de hash. A seguir, a próxima função de hash é usada para definir outro bit, e assim por diante. Uma vez que todas as M funções de hash forem aplicadas, o padrão de busca será "registrado" no filtro de bloom como M bits que mudaram de 0 para 1.</p>
</div>
<div class="paragraph data-line-224">
<p>A <a href="#bloom2">Adicionando um padrão "A" para o nosso filtro de bloom simples</a> é um exemplo da adição de um padrão "A" para o filtro de bloom simples mostrado na <a href="#bloom1">Um exemplo de um filtro de bloom simples, com um campo de 16 bits e três funções de hash</a>.</p>
</div>
<div class="paragraph data-line-226">
<p>Adicionar um segundo padrão é tão simples quanto repetir esse processo. O padrão é transformado em hash por cada função de hash de cada vez e o resultado é registrado ao se definir os bits como 1. Observe que à medida que o filtro de bloom é preenchido com mais padrões, um resultado de função de hash pode coincidir com um bit que já esteja definido como 1, neste caso o bit não é modificado. Em essência, à medida que mais padrões gravam em bits sobreponentes, o filtro de bloom começa a se tornar saturado com mais bits definidos como 1 e a acurácia do filtro diminui. É por isso que o filtro é uma estrutura de dados probabilística—ele se torna menos preciso à medida que mais padrões são adicionados. A acurácia depende do número de padrões adicionados versus o tamanho do array de bits (N) e o número de funções de hash (M). Um array de bits maior e mais funções de hash podem registrar mais padrões com maior acurácia. Um array de bits menor ou menos funções de hash registrarão menos padrões e terão menor acurácia.</p>
</div>
<div id="bloom2" class="imageblock data-line-230">
<div class="content">
<img src="images/mbc2_0809.png" alt="Bloom2">
</div>
<div class="title">Figure 9. Adicionando um padrão "A" para o nosso filtro de bloom simples</div>
</div>
<div class="paragraph data-line-232">
<p>A <a href="#bloom3">Adicionando um segundo padrão "B" para o nosso filtro de bloom simples</a> é um exemplo da adição de um segundo padrão "B" para o filtro de bloom simples.</p>
</div>
<div id="bloom3" class="imageblock smallereighty data-line-237">
<div class="content">
<img src="images/mbc2_0810.png" alt="Bloom3">
</div>
<div class="title">Figure 10. Adicionando um segundo padrão "B" para o nosso filtro de bloom simples</div>
</div>
<div class="paragraph data-line-239">
<p>Para testar se um padrão faz parte de um filtro de bloom, o padrão é transformado em hash por cada função de hash e o padrão de bits resultante é testado contra o array de bits. Se todos os bits indexados pelas funções de hash forem definidos como 1, então o padrão é <em>provavelmente</em> registrado no filtro de bloom. Como os bits podem ser definidos devido à sobreposição de múltiplos padrões, a resposta não é uma certeza, ela é probabilística. Em outras palavras, uma correspondência positiva no filtro de bloom é um "Talvez, Sim".</p>
</div>
<div class="paragraph data-line-241">
<p>A <a href="#bloom4">Testando a existência de um padrão "X" no filtro de bloom. O resultado é uma correspondência positiva probabilística, significando "Talvez".</a> é um exemplo que testa a existência do padrão "X" no filtro de bloom simples. Os bits correspondentes estão definidos como 1, então o padrão é provavelmente uma correspondência.</p>
</div>
<div id="bloom4" class="imageblock smallereighty data-line-246">
<div class="content">
<img src="images/mbc2_0811.png" alt="Bloom4">
</div>
<div class="title">Figure 11. Testando a existência de um padrão "X" no filtro de bloom. O resultado é uma correspondência positiva probabilística, significando "Talvez".</div>
</div>
<div class="paragraph data-line-248">
<p>Por outro lado, se um padrão for testado contra um filtro de bloom e qualquer um dos bits estiver definido como 0, isso prova que o padrão não foi registrado no filtro de bloom. O resultado negativo não é uma probabilidade, ele é uma certeza. Em outras palavras, uma correspondência negativa no filtro de bloom é um "Definitivamente Não!".</p>
</div>
<div class="paragraph data-line-250">
<p>A <a href="#bloom5">Testando a existência do padrão "Y" no filtro de bloom. O resultado é uma correspondência negativa definitiva, significando "Definitivamente Não!"</a> é um exemplo que testa a existência do padrão "Y" no filtro de bloom simples. Um dos bits correspondentes está definido como 0, então o padrão definitivamente não é uma correspondência.</p>
</div>
<div id="bloom5" class="imageblock data-line-254">
<div class="content">
<img src="images/mbc2_0812.png" alt="mbc2 0812">
</div>
<div class="title">Figure 12. Testando a existência do padrão "Y" no filtro de bloom. O resultado é uma correspondência negativa definitiva, significando "Definitivamente Não!"</div>
</div>
</div>
</div>
<div class="sect2 data-line-256">
<h3 id="_como_os_nós_de_spv_usam_os_filtros_de_bloom">Como os Nós de SPV usam os Filtros de Bloom</h3>
<div class="paragraph data-line-258">
<p>Os filtros de bloom são usados para filtrar as transações (e os blocos que as contêm) que um nó de SPV recebe de seus pares, selecionando apenas as transações de interesse para o nó de SPV, sem revelar em quais endereços ou chaves ele está interessado.</p>
</div>
<div class="paragraph data-line-260">
<p>Um nó de SPV inicializará um filtro de bloom como "vazio"; nesse estado, o filtro de bloom não corresponderá a nenhum padrão. A seguir, o nó de SPV fará uma lista de todos os endereços, chaves e hashes nos quais ele está interessado. Ele fará isso extraindo o hash da chave pública, o hash do script e os IDs de transação de qualquer UTXO controlada por sua carteira. O nó de SPV então adiciona cada um deles ao filtro de bloom, de modo que o filtro de bloom irá "encontrar uma correspondência" caso esses padrões estiverem presentes em uma transação, sem revelar os padrões.</p>
</div>
<div class="paragraph data-line-262">
<p>The SPV node will then send a filterload message to the peer, containing the bloom filter to use on the connection. On the peer, bloom filters are checked against each incoming transaction. The full node checks several parts of the transaction against the bloom filter, looking for a match including:</p>
</div>
<div class="ulist data-line-264">
<ul>
<li class="data-line-264">
<p>O ID da transação</p>
</li>
<li class="data-line-265">
<p>Os componentes de dados dos scripts de travamento de cada uma das saídas da transação (cada chave e cada hash no script)</p>
</li>
<li class="data-line-266">
<p>Cada uma das entradas da transação</p>
</li>
<li class="data-line-267">
<p>Cada um dos componentes de dados de assinatura de entrada (ou scripts de testemunha)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-269">
<p>Ao serem verificados contra todos esses componentes, os filtros de bloom podem ser usados para buscar correspondências de hashes de chave pública, scripts, valores de OP_RETURN, chaves públicas em assinaturas ou qualquer componente futuro de um contrato inteligente ou de um script complexo.</p>
</div>
<div class="paragraph data-line-271">
<p>Depois que um filtro é estabelecido, o par testará cada saída da transação com o filtro de bloom. Apenas as transações que correspondem ao filtro são enviadas para o nó.</p>
</div>
<div class="paragraph data-line-273">
<p>Em resposta a uma mensagem getdata vindo do nó, os pares enviarão uma mensagem merkleblock que contém somente os cabeçalhos de bloco para os blocos correspondentes ao filtro e um caminho de merkle (ver <a href="#merkle_trees">[merkle_trees]</a>) para cada transação correspondente. O par também enviará mensagens tx contendo as transações que correspondem ao filtro.</p>
</div>
<div class="paragraph data-line-275">
<p>À medida que o nó completo envia transações para o nó de SPV, o nó de SPV descarta todos os falsos positivos e usa as transações correspondentes corretas para atualizar o seu conjunto UTXO e o saldo da carteira. Ao atualizar sua própria visão do conjunto UTXO, ele também modifica o filtro de bloom para filtrar quaisquer transações futuras que façam referência à UTXO que ele acabou de encontrar. O nó completo então usa o novo filtro de bloom para filtrar as novas transações e todo o processo se repete.</p>
</div>
<div class="paragraph data-line-277">
<p>O nó definindo o filtro de bloom pode adicionar padrões ao filtro de maneira interativa ao enviar uma mensagem filteradd. Para limpar o filtro de bloom, o nó pode enviar uma mensagem filterclear. Como não é possível remover um padrão de um filtro de bloom, caso um padrão não seja mais desejado, um nó deverá limpar o filtro atual e reenviar um novo filtro de bloom.</p>
</div>
<div class="paragraph data-line-279">
<p>O protocolo de rede e o mecanismo de filtro de bloom para nodes SPV são definidos em <a href="https://bit.ly/1x6qCiO" data-href="https://bit.ly/1x6qCiO">BIP-37(Peer Services)</a>.</p>
</div>
</div>
<div class="sect2 data-line-282">
<h3 id="_nós_de_spv_e_privacidade">Nós de SPV e Privacidade</h3>
<div class="paragraph data-line-284">
<p>Os nós que implementam a verificação de pagamento simplificada têm uma privacidade mais fraca do que um nó completo. Um nó completo recebe todas as transações e, portanto, não revela se está usando algum endereço de sua carteira. Por outro lado, um nó de SPV recebe uma lista filtrada de transações relacionadas aos endereços que estão em sua carteira. Como resultado, ele reduz a privacidade do proprietário.</p>
</div>
<div class="paragraph data-line-286">
<p>Os filtros de bloom são uma maneira de reduzir a perda de privacidade. Sem eles, um nó de SPV teria que listar explicitamente os endereços nos quais ele estivesse interessado, criando uma grave violação de privacidade. No entanto, mesmo com os filtros de bloom, um adversário pode coletar informações suficientes ao longo do tempo, descobrindo quais são os endereços que estão contidos na carteira do cliente de SPV. Para fazer isso, ele pode monitorar o tráfego de um cliente de SPV ou conectar-se diretamente a ele como um nó na rede P2P.</p>
</div>
</div>
<div class="sect2 data-line-288">
<h3 id="_conexões_criptografadas_e_autenticadas">Conexões Criptografadas e Autenticadas</h3>
<div class="paragraph data-line-290">
<p>Most new users of bitcoin assume that the network communications of a Bitcoin node are encrypted. In fact, the original implementation of bitcoin communicates entirely in the clear. While this is not a major privacy concern for full nodes, it is a big problem for SPV nodes.</p>
</div>
<div class="paragraph data-line-292">
<p>Como forma de aumentar a privacidade e a segurança da rede P2P do bitcoin, existem duas soluções que fornecem criptografia das comunicações: <em>Transporte Tor</em> e <em>Autenticação e Criptografia P2P</em> com a BIP-150 e a BIP-151.</p>
</div>
<div class="sect3 data-line-294">
<h4 id="_transporte_tor">Transporte Tor</h4>
<div class="paragraph data-line-296">
<p>O Tor, que significa <em>A Rede de Roteamento Cebola</em> (em inglês, <em>The Onion Routing network</em>), é um projeto de software e de rede que oferece criptografia e encapsulamento de dados por meio de caminhos de rede randomizados que oferecem anonimato, irrastreabilidade e privacidade.</p>
</div>
<div class="paragraph data-line-298">
<p>Bitcoin Core offers several configuration options that allow you to run a Bitcoin node with its traffic transported over the Tor network. In addition, Bitcoin Core can also offer a Tor hidden service allowing other Tor nodes to connect to your node directly over Tor.</p>
</div>
<div class="paragraph data-line-300">
<p>A partir da versão 0.12 do Bitcoin Core, um nó oferecerá um serviço oculto do Tor automaticamente se ele for capaz de se conectar a um serviço Tor local. Se você tiver o Tor instalado e o processo do Bitcoin Core for executado como um usuário com permissões adequadas para acessar o cookie de autenticação do Tor, ele deve funcionar automaticamente. Use a flag debug para ativar a depuração do Bitcoin Core para o serviço do Tor, dessa maneira:</p>
</div>
<div class="listingblock data-line-302">
<div class="content">
<pre>$ bitcoind --daemon --debug=tor</pre>
</div>
</div>
<div class="paragraph data-line-306">
<p>Você deverá ver a mensagem "tor: ADD_ONION successful" nos logs, indicando que o Bitcoin Core adicionou um serviço oculto à rede Tor.</p>
</div>
<div class="paragraph data-line-308">
<p>Você pode encontrar mais instruções sobre como executar o Bitcoin Core como um serviço oculto do Tor na documentação do Bitcoin Core (<em>docs / tor.md</em>) e em vários tutoriais online.</p>
</div>
</div>
<div class="sect3 data-line-310">
<h4 id="_autenticação_e_criptografia_par_a_par">Autenticação e Criptografia Par-a-Par</h4>
<div class="paragraph data-line-312">
<p>Two Bitcoin Improvement Proposals, BIP-150 and BIP-151, add support for P2P authentication and encryption in the bitcoin P2P network. These two BIPs define optional services that may be offered by compatible Bitcoin nodes. BIP-151 enables negotiated encryption for all communications between two nodes that support BIP-151. BIP-150 offers optional peer authentication that allows nodes to authenticate each other&#8217;s identity using ECDSA and private keys. BIP-150 requires that prior to authentication the two nodes have established encrypted communications as per BIP-151.</p>
</div>
<div class="paragraph data-line-314">
<p>As of February 2021, BIP-150 and BIP-151 are not implemented in Bitcoin Core. However, the two proposals have been implemented by at least one alternative Bitcoin client named bcoin.</p>
</div>
<div class="paragraph data-line-316">
<p>A BIP-150 e a BIP-151 permitem que os usuários executem clientes de SPV que se conectam a um nó completo de confiança, usando criptografia e autenticação para proteger a privacidade do cliente de SPV.</p>
</div>
<div class="paragraph data-line-318">
<p>Additionally, authentication can be used to create networks of trusted Bitcoin nodes and prevent Man-in-the-Middle attacks. Finally, P2P encryption, if deployed broadly, would strengthen the resistance of bitcoin to traffic analysis and privacy-eroding surveillance, especially in totalitarian countries where internet use is heavily controlled and monitored.</p>
</div>
<div class="paragraph data-line-320">
<p>O padrão é definido na <a href="https://github.com/bitcoin/bips/blob/master/bip-0150.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0150.mediawiki">BIP-150 (Autenticação de Par)</a> e na <a href="https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki">BIP-151 (Criptografia de Comunicação Par-a-Par)</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-322">
<h3 id="_pools_de_transações">Pools de Transações</h3>
<div class="paragraph data-line-324">
<p>Almost every node on the Bitcoin network maintains a temporary list of unconfirmed transactions called the <em>memory pool</em>, <em>mempool</em>, or <em>transaction pool</em>. Nodes use this pool to keep track of transactions that are known to the network but are not yet included in the blockchain. For example, a wallet node will use the transaction pool to track incoming payments to the user&#8217;s wallet that have been received on the network but are not yet confirmed.</p>
</div>
<div class="paragraph data-line-326">
<p>À medida que as transações são recebidas e verificadas, elas vão sendo adicionadas ao pool de transações e retransmitidas aos nós vizinhos para serem propagadas para a rede.</p>
</div>
<div class="paragraph data-line-328">
<p>Algumas implementações de nós também mantêm uma pool separada de transações órfãs. Caso uma entrada de transação referir-se a uma transação que ainda não seja conhecida, como, por exemplo, uma transação pai desconhecida, a transação órfã será armazenada temporariamente na pool de transações órfãs até que a transação pai seja recebida.</p>
</div>
<div class="paragraph data-line-330">
<p>Quando uma transação é adicionada à pool de transações, verifica-se na pool de transações órfãs se há quaisquer transações órfãs com referências para as saídas dessa transação recém-adicionada, em outras palavras, verifica-se se há transações que sejam filhas dessa transação. Quaisquer transações órfãs correspondentes são então validadas. Se elas forem válidas, elas são removidas da pool de transações órfãs e são adicionadas à pool de transações, completando a cadeia que iniciou com a transação pai. Na presença de uma transação recém-adicionada, que não é mais uma transação órfã, o processo é repetido recursivamente em busca de quaisquer outras transações descendentes, até que não se encontre mais nenhuma descendente. Através desse processo, a chegada de uma transação pai desencadeia uma reconstrução em cascata de uma cadeia completa de transações interdependentes ao reunir as transações órfãs com suas transações pais ao longo de toda a cadeia.</p>
</div>
<div class="paragraph data-line-332">
<p>Tanto a pool de transações quanto a pool de transações órfãs (quando implementada) são armazenadas na memória local e não são salvas em um armazenamento persistente; em vez disso, elas são preenchidas dinamicamente a partir das mensagens recebidas da rede. Quando um nó é iniciado, ambas as pools estão vazias e passam a ser gradualmente preenchidas com as novas transações que são recebidas da rede.</p>
</div>
<div class="paragraph data-line-334">
<p>Some implementations of the Bitcoin client also maintain an UTXO database or pool, which is the set of all unspent outputs on the blockchain. Bitcoin Core users will find it in the chainstate/ folder of their client&#8217;s data directory. Although the name "UTXO pool" sounds similar to the transaction pool, it represents a different set of data. Unlike the transaction and orphan pools, the UTXO pool is not initialized empty but instead contains millions of entries of unspent transaction outputs, everything that is unspent from all the way back to the genesis block. The UTXO pool may be housed in local memory or as an indexed database table on persistent storage.</p>
</div>
<div class="paragraph data-line-336">
<p>Enquanto a pool de transações e a pool de transações órfãs representam uma perspectiva local de um nó isolado, e podem variar significativamente de nó para nó dependendo de quando o nó foi iniciado ou reiniciado, a pool de UTXOs representa o consenso emergente da rede e, portanto, apresentará pouca variação entre os nós. Além disso, a pool de transações e a pool de transações órfãs contêm somente transações não confirmadas, enquanto a pool de UTXOs contém somente saídas confirmadas.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-07-10 05:52:45 -0400
</div>
</div>
</body>
</html>